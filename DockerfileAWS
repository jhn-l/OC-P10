# Utilisation de l'image AWS Lambda Python 3.12
FROM public.ecr.aws/lambda/python:3.12

# DÃ©finition du rÃ©pertoire de travail
WORKDIR /var/task

# ğŸ”¹ Installer les outils de compilation (nÃ©cessaires pour `scikit-surprise`)
RUN yum install -y gcc gcc-c++ make libstdc++-devel

# ğŸ”¹ DÃ©finition des variables d'environnement pour Ã©viter les erreurs de Surprise
ENV SURPRISE_DATASET_DIR=/tmp

# ğŸ”¹ Installation des dÃ©pendances Python dans le bon chemin
RUN pip install --no-cache-dir pandas numpy scikit-learn scikit-surprise boto3 \
    --target /var/lang/lib/python3.12/site-packages

# ğŸ”¹ Copier le fichier source dans le conteneur
COPY hybrid_recommender.py .

# ğŸ”¹ DÃ©finition du point d'entrÃ©e de la Lambda
CMD ["hybrid_recommender.lambda_handler"]
