# Utilisation de l'image AWS Lambda Python 3.8
FROM public.ecr.aws/lambda/python:3.8

# DÃ©finition du rÃ©pertoire de travail pour AWS Lambda
WORKDIR /var/task

# ðŸ”¹ Installer les outils de compilation nÃ©cessaires pour `scikit-surprise`
RUN yum install -y gcc gcc-c++ make libstdc++-devel

# ðŸ”¹ DÃ©finition des variables d'environnement pour Ã©viter les erreurs de Surprise
ENV SURPRISE_DATASET_DIR=/tmp

# ðŸ”¹ Installation des dÃ©pendances Python dans le bon chemin pour Python 3.8
RUN pip install --no-cache-dir pandas numpy scikit-learn scikit-surprise boto3 \
    --target /var/lang/lib/python3.8/site-packages

# ðŸ”¹ Copier le fichier source dans le conteneur
COPY hybrid_recommender.py .

# ðŸ”¹ DÃ©finition du point d'entrÃ©e de la Lambda
CMD ["hybrid_recommender.lambda_handler"]
