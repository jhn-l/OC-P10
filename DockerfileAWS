# Utilisation de l'image AWS Lambda
FROM public.ecr.aws/lambda/python:3.12

# D√©finition du r√©pertoire de travail
WORKDIR /var/task

# Installation des outils de compilation
RUN yum install -y gcc gcc-c++ make libstdc++-devel

# üîπ D√©finition des variables d'environnement pour forcer Surprise √† utiliser /tmp
ENV SURPRISE_DATASET_DIR=/tmp

# Installation des d√©pendances (avec --target pour √©viter les probl√®mes de chemin)
RUN pip install --no-cache-dir pandas numpy scikit-learn scikit-surprise boto3 --target /var/task

# Copier le code source
COPY hybrid_recommender.py .

# D√©finition du point d'entr√©e
CMD ["hybrid_recommender.lambda_handler"]
