# Utilisation de l'image AWS Lambda
FROM public.ecr.aws/lambda/python:3.12

# DÃ©finition du rÃ©pertoire de travail
WORKDIR /var/task

# ðŸ”¹ Mise Ã  jour des paquets et installation des outils de compilation
RUN apt-get update && apt-get install -y gcc g++ make libstdc++-dev

# ðŸ”¹ DÃ©finition des variables d'environnement pour forcer Surprise Ã  utiliser /tmp
ENV SURPRISE_DATASET_DIR=/tmp

# Installation des dÃ©pendances (avec --target pour Ã©viter les problÃ¨mes de chemin)
RUN pip install --no-cache-dir pandas numpy scikit-learn scikit-surprise boto3 --target /var/task

# Copier le code source
COPY hybrid_recommender.py .

# DÃ©finition du point d'entrÃ©e
CMD ["hybrid_recommender.lambda_handler"]
